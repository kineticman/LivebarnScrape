version: '3.8'

services:
  livebarn:
    build: .
    container_name: livebarn-manager
    restart: unless-stopped

    # Bind host port -> container port using SERVER_PORT
    ports:
      - "${SERVER_PORT:-5000}:${SERVER_PORT:-5000}"

    environment:
      # LiveBarn Credentials (REQUIRED)
      - LIVEBARN_EMAIL=${LIVEBARN_EMAIL}
      - LIVEBARN_PASSWORD=${LIVEBARN_PASSWORD}

      # Network Configuration (IMPORTANT - Set your LAN IP!)
      - LAN_IP=${LAN_IP:-192.168.1.100}  # Change to your server's LAN IP

      # Optional Configuration
      - SERVER_PORT=${SERVER_PORT:-5000}
      - TZ=America/New_York  # Set your timezone for correct scheduling
      - LOG_LEVEL=INFO

    volumes:
      # Persistent database storage
      - ./data:/data

    # Use host network mode for better LAN IP detection (optional)
    # Uncomment if you want the container to use your host's network directly
    # network_mode: host

    # If using host network mode, comment out the ports section above

volumes:
  data:
    driver: local

